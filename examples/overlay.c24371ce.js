import"./buildings.88bb1910.js";var e=globalThis,t={},o={},i=e.parcelRequire73bb;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in o){var i=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,i.call(n.exports,n,n.exports),n.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){o[e]=t},e.parcelRequire73bb=i),i.register;var n=i("cc3xD"),s=i("5DwXE"),a=i("9jDAx"),l=i("4mWlF"),r=i("dpRHA"),d=i("9DiKA"),c=i("f3WAG"),p=i("haRZ2"),u=i("2o3CH"),h=i("5gNCk");let m=new(0,a.default),v=new(0,s.default)({layers:[new(0,l.default)({source:m})],controls:(0,c.defaults)({attributionOptions:{collapsible:!1}}),target:"map",view:new(0,d.default)({center:(0,r.transform)([-112.2,36.06],"EPSG:4326","EPSG:3857"),zoom:11})}),y=new(0,n.default)({map:v,target:"mapCesium"}),g=y.getCesiumScene();new class{constructor(e,t,o){this.ol2d=e,this.ol3d=t,this.scene=o,this.staticOverlay=new(0,p.default)({element:document.getElementById("popup")}),this.staticBootstrapPopup=new(0,p.default)({element:document.getElementById("popup-bootstrap")}),this.ol2d.addOverlay(this.staticOverlay),this.ol2d.addOverlay(this.staticBootstrapPopup),this.options={boostrap:!1,add:!0},this.ol2d.on("click",this.onClickHandlerOL.bind(this)),new Cesium.ScreenSpaceEventHandler(o.canvas).setInputAction(this.onClickHandlerCS.bind(this),Cesium.ScreenSpaceEventType.LEFT_CLICK),document.getElementById("click-action-form").onchange=()=>{let e=document.querySelector('input[name="click-action"]:checked')?.value;this.options.add="add"===e},document.getElementById("overlay-type-form").onchange=e=>{let t=document.querySelector('input[name="overlay-type"]:checked')?.value;this.options.boostrap="popover"===t}}onClickHandlerOL(e){let t=e.coordinate,o=(0,u.toStringHDMS)((0,r.transform)(t,"EPSG:3857","EPSG:4326")),i=this.getOverlay();i.setPosition(t),this.setOverlayContent(i,o)}onClickHandlerCS(e){if(0===e.position.x&&0===e.position.y)return;let t=this.scene.camera.getPickRay(e.position),o=this.scene.globe.pick(t,g);if(!o)return;let i=g.globe.ellipsoid.cartesianToCartographic(o),n=[Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude)],s=g.globe.getHeight(i);s&&(n=n.concat([s]));let a=(0,r.transform)(n,(0,r.get)("EPSG:4326"),"EPSG:3857"),l=(0,u.toStringHDMS)(n),d=this.getOverlay();d.setPosition(a),this.setOverlayContent(d,l)}getOverlay(){return this.options.add?this.addOverlay():this.options.boostrap?this.staticBootstrapPopup:this.staticOverlay}setOverlayContent(e,t){let o=e.getElement();if(this.options.boostrap){let i=document.createElement("div");i.onclick=this.onCloseClick.bind(this,e,this.options.add),i.innerHTML=`<p>The location you clicked was:</p><code>${t}</code>`,$(o).popover("destroy"),$(o).popover({placement:"top",animation:!1,html:!0,content:i}),$(o).popover("show")}else o.childNodes.forEach(o=>{"popup-content"===o.id?o.innerHTML=`<p>The location you clicked was:</p><code>${t}</code>`:"popup-closer"===o.id&&(o.onclick=this.onCloseClick.bind(this,e,this.options.add))})}onCloseClick(e,t){t?this.ol2d.removeOverlay(e):e.setPosition(void 0)}addOverlay(){let e;e=this.options.boostrap?document.getElementById("popup-bootstrap").cloneNode(!0):document.getElementById("popup").cloneNode(!0);let t=new(0,p.default)({element:e});return this.ol2d.addOverlay(t),t}}(v,y,g),document.getElementById("enable").addEventListener("click",()=>y.setEnabled(!y.getEnabled())),(0,h.initCodeSandbox)("rawjs/overlay.js");
//# sourceMappingURL=overlay.c24371ce.js.map
